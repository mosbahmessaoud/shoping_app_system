<script>
// ========================================
// YouCan Store - Algeria Provinces Integration
// With Google Sheets Data Saving
// ========================================

// Configuration
const CONFIG = {
    googleSheetsWebhook: 'https://script.google.com/macros/s/AKfycbxBgK2uSP7-WM_0E-rTRHbT2Sql1vJY6PNqOG6DpluIxs7iVG4mg-84-1tZp7zs1WzkOQ/exec', // Replace with your Google Apps Script URL
    provinceFieldName: 'extra_fields[custom_field_D1VXty9CRFYOSqBf]',
    communeFieldName: 'extra_fields[custom_field_tG3HbgvMB9Y2ayn3]',
    deliveryFieldName: 'extra_fields[custom_field_sKIKxxoBLFNHrN3Q]'
};

// Algeria Administrative Data
const ALGERIA_DATA = {
    "wilayas": [
        {"id": 1, "name_ar": "أدرار", "name_latin": "Adrar"},
        {"id": 2, "name_ar": "الشلف", "name_latin": "Chlef"},
        {"id": 3, "name_ar": "الأغواط", "name_latin": "Laghouat"},
        {"id": 4, "name_ar": "أم البواقي", "name_latin": "Oum El Bouaghi"},
        {"id": 5, "name_ar": "باتنة", "name_latin": "Batna"},
        {"id": 6, "name_ar": "بجاية", "name_latin": "Bejaia"},
        {"id": 7, "name_ar": "بسكرة", "name_latin": "Biskra"},
        {"id": 8, "name_ar": "بشار", "name_latin": "Bechar"},
        {"id": 9, "name_ar": "البليدة", "name_latin": "Blida"},
        {"id": 10, "name_ar": "البويرة", "name_latin": "Bouira"},
        {"id": 11, "name_ar": "تمنراست", "name_latin": "Tamanrasset"},
        {"id": 12, "name_ar": "تبسة", "name_latin": "Tebessa"},
        {"id": 13, "name_ar": "تلمسان", "name_latin": "Tlemcen"},
        {"id": 14, "name_ar": "تيارت", "name_latin": "Tiaret"},
        {"id": 15, "name_ar": "تيزي وزو", "name_latin": "Tizi Ouzou"},
        {"id": 16, "name_ar": "الجزائر", "name_latin": "Alger"},
        {"id": 17, "name_ar": "الجلفة", "name_latin": "Djelfa"},
        {"id": 18, "name_ar": "جيجل", "name_latin": "Jijel"},
        {"id": 19, "name_ar": "سطيف", "name_latin": "Setif"},
        {"id": 20, "name_ar": "سعيدة", "name_latin": "Saida"},
        {"id": 21, "name_ar": "سكيكدة", "name_latin": "Skikda"},
        {"id": 22, "name_ar": "سيدي بلعباس", "name_latin": "Sidi Bel Abbes"},
        {"id": 23, "name_ar": "عنابة", "name_latin": "Annaba"},
        {"id": 24, "name_ar": "قالمة", "name_latin": "Guelma"},
        {"id": 25, "name_ar": "قسنطينة", "name_latin": "Constantine"},
        {"id": 26, "name_ar": "المدية", "name_latin": "Medea"},
        {"id": 27, "name_ar": "مستغانم", "name_latin": "Mostaganem"},
        {"id": 28, "name_ar": "المسيلة", "name_latin": "M'Sila"},
        {"id": 29, "name_ar": "معسكر", "name_latin": "Mascara"},
        {"id": 30, "name_ar": "ورقلة", "name_latin": "Ouargla"},
        {"id": 31, "name_ar": "وهران", "name_latin": "Oran"},
        {"id": 32, "name_ar": "البيض", "name_latin": "El Bayadh"},
        {"id": 33, "name_ar": "إليزي", "name_latin": "Illizi"},
        {"id": 34, "name_ar": "برج بوعريريج", "name_latin": "Bordj Bou Arreridj"},
        {"id": 35, "name_ar": "بومرداس", "name_latin": "Boumerdes"},
        {"id": 36, "name_ar": "الطارف", "name_latin": "El Tarf"},
        {"id": 37, "name_ar": "تندوف", "name_latin": "Tindouf"},
        {"id": 38, "name_ar": "تيسمسيلت", "name_latin": "Tissemsilt"},
        {"id": 39, "name_ar": "الوادي", "name_latin": "El Oued"},
        {"id": 40, "name_ar": "خنشلة", "name_latin": "Khenchela"},
        {"id": 41, "name_ar": "سوق أهراس", "name_latin": "Souk Ahras"},
        {"id": 42, "name_ar": "تيبازة", "name_latin": "Tipaza"},
        {"id": 43, "name_ar": "ميلة", "name_latin": "Mila"},
        {"id": 44, "name_ar": "عين الدفلى", "name_latin": "Ain Defla"},
        {"id": 45, "name_ar": "النعامة", "name_latin": "Naama"},
        {"id": 46, "name_ar": "عين تموشنت", "name_latin": "Ain Temouchent"},
        {"id": 47, "name_ar": "غرداية", "name_latin": "Ghardaia"},
        {"id": 48, "name_ar": "غليزان", "name_latin": "Relizane"},
        {"id": 49, "name_ar": "تيميمون", "name_latin": "Timimoun"},
        {"id": 50, "name_ar": "برج باجي مختار", "name_latin": "Bordj Badji Mokhtar"},
        {"id": 51, "name_ar": "أولاد جلال", "name_latin": "Ouled Djellal"},
        {"id": 52, "name_ar": "بني عباس", "name_latin": "Beni Abbes"},
        {"id": 53, "name_ar": "عين صالح", "name_latin": "In Salah"},
        {"id": 54, "name_ar": "عين قزام", "name_latin": "In Guezzam"},
        {"id": 55, "name_ar": "تقرت", "name_latin": "Touggourt"},
        {"id": 56, "name_ar": "جانت", "name_latin": "Djanet"},
        {"id": 57, "name_ar": "المغير", "name_latin": "El M'Ghair"},
        {"id": 58, "name_ar": "المنيعة", "name_latin": "El Meniaa"},
        {"id": 59, "name_ar": "أفلو", "name_latin": "Aflou"},
        {"id": 60, "name_ar": "الأبيض سيدي الشيخ", "name_latin": "El Abiodh Sidi Cheikh"},
        {"id": 61, "name_ar": "العريشة", "name_latin": "El Aricha"},
        {"id": 62, "name_ar": "القنطرة", "name_latin": "El Kantara"},
        {"id": 63, "name_ar": "بريكة", "name_latin": "Barika"},
        {"id": 64, "name_ar": "بوسعادة", "name_latin": "Bou Saada"},
        {"id": 65, "name_ar": "بير العاتر", "name_latin": "Bir El Ater"},
        {"id": 66, "name_ar": "قصر البخاري", "name_latin": "Ksar El Boukhari"},
        {"id": 67, "name_ar": "قصر الشلالة", "name_latin": "Ksar Chellala"},
        {"id": 68, "name_ar": "عين وسارة", "name_latin": "Ain Oussara"},
        {"id": 69, "name_ar": "مسعد", "name_latin": "Messaad"}
    ],
    "communes": {
        "1": ["تيمقتن", "بودة", "أولاد أحمد تيمي", "أدرار", "فنوغيل", "إن زغمير", "رقان", "سالي", "السبع", "تسابيت", "تامست", "تامنطيط", "تيت", "زاوية كنتة", "اقبلي", "أولف"],
        "2": ["تلعصة", "الزبوجة", "الحجاج", "أولاد بن عبد القادر", "عين مران", "بريرة", "أولاد عباس", "وادي الفضة", "بني راشد", "الهرانفة", "تاجنة", "المرسى", "الشلف", "أم الدروع", "سنجاس", "سيدي عبد الرحمن", "سيدي عكاشة", "تنس", "بني بوعتاب", "الكريمية", "حرشون", "بوزغاية", "تاوقريت", "بني حواء", "أبو الحسن", "وادي قوسين", "الشطية", "مصدق", "أولاد فارس", "بوقادير", "وادي سلي", "الصبحة", "بنايرية", "الأبيض مجاجة", "الظهرة"],
        "3": ["تاجموت", "تاجرونة", "الأغواط", "قصر الحيران", "العسافية", "سيدي مخلوف", "حاسي الدلاعة", "حاسي الرمل", "عين ماضي", "الحويطة", "الخنق", "بن ناصر بن شهرة"],
        "4": ["فكيرينة", "الفجوج بوغرارة سعودي", "عين فكرون", "الرحية", "مسكيانة", "البلالة", "بحير الشرقي", "قصر الصباحي", "سوق نعمان", "أولاد زواي", "أم البواقي", "عين ببوش", "عين الزيتون", "بئر الشهداء", "عين البيضاء", "بريش", "الزرق", "عين مليلة", "أولاد قاسم", "أولاد حملة", "العامرية", "سيقوس", "وادي نيني", "عين الديس", "الضلعة", "الجازية", "عين كرشة", "الحرملية", "هنشير تومغني"],
        "5": ["معافة", "القصبات", "تيمقاد", "تاكسلانت", "أولاد سي سليمان", "لمسان", "تالخمت", "رأس العيون", "الرحبات", "أولاد سلام", "القيقبة", "ثنية العابد", "باتنة", "فسديس", "وادي الشعبة", "حيدوسة", "قصر بلزمة", "مروانة", "وادي الماء", "لازرو", "سريانة", "زانة البيضاء", "منعة", "تغرغار", "عين ياقوت", "بومية", "جرمة", "المعذر", "عيون العصافير", "تازولت", "بومقر", "نقاوس", "سفيان", "أريس", "تيغانمين", "عين جاسر", "الحاسي", "فم الطوب", "إشمول", "إينوغيسن", "بوزينة", "لارباع", "بولهيلات", "الشمرة", "غسيرة", "كيمل", "تكوت", "عين التوتة", "بني فضالة الحقانية", "أولاد فاضل", "أولاد عوف", "شير", "وادي الطاقة"],
        "6": ["سيدي عياد", "برباشة", "الفلاي", "كنديرة", "سيدي عيش", "تيفرة", "تينبدار", "القصر", "فناية الماثن", "توجة", "ذراع القايد", "خراطة", "بجاية", "وادي غير", "بني معوش", "بني جليل", "فرعون", "سمعون", "تيمزريت", "مالبو", "سوق لإثنين", "تامريجت", "بوخليفة", "تالة حمزة", "تيشي", "أيت رزين", "إغيل علي", "أيت إسماعيل", "درقينة", "تاسكريوت", "أوقاس", "تيزي نبربر", "أدكار", "بني كسيلة", "تاوريرت إغيل", "أقبو", "شلاطة", "اغرم", "تامقرة", "أمالو", "بوحمزة", "مسيسنة", "صدوق", "بني مليكش", "بو جليل", "تازمالت", "أكفادو", "شميني", "سوق اوفلا", "طيبان", "أوزلاقن", "أميزور"],
        "7": ["الفيض", "ليشانة", "بوشقرون", "مخادمة", "خنقة سيدي ناجي", "زريبة الوادي", "المزيرعة", "بسكرة", "الحاجب", "مليلي", "فوغالة", "الغروس", "برج بن عزوز", "أورلال", "أوماش", "عين الناقة", "شتمة", "الحوش", "سيدي عقبة", "مشونش", "ليوة", "طولقة"],
        "8": ["بشار", "بوكايس", "لحمر", "موغل", "المريجة", "تاغيت", "العبادلة", "عرق فراج", "مشرع هواري بومدين", "بني ونيف", "تبلبالة", "القنادسة"],
        "9": ["بني مراد", "اولاد سلامة", "موزاية", "حمام ملوان", "بوقرة", "صوحان", "الأربعاء", "الصومعة", "قرواو", "بوفاريك", "مفتاح", "الشفة", "عين الرمانة", "وادي جر", "العفرون", "أولاد يعيش", "الشريعة", "جبابرة", "وادي العلايق", "بن خليل", "بني تامو", "الشبلي", "بوعينان", "بوعرفة", "البليدة"],
        "10": ["عين العلوي", "الحجرة الزرقاء", "مزدور", "تاقديت", "ريدان", "المعمورة", "الحاكمية", "أهل القصر", "ديرة", "الدشمية", "بشلول", "آث منصور", "سحاريج", "العجيبة", "الأسنام", "أمشدالة", "برج أوخريص", "سور الغزلان", "حنيف", "شرفة", "أولاد راشد", "عين الحجر", "أغبالو", "روراوة", "الخبوزية", "بئر غبالو", "البويرة", "عين الترك", "أيت لعزيز", "عين بسام", "المقراني", "سوق الخميس", "أعمر", "جباحية", "الهاشمية", "حيزر", "تاغزوت", "بودربالة", "بوكرم", "قرومة", "الأخضرية", "معلة", "قادرية", "زبربر", "وادي البردي"],
        "11": ["تاظروك", "ابلسة", "تمنراست", "عين امقل", "أدلس"],
        "12": ["الحويجبات", "العوينات", "بئر مقدم", "بئر الذهب", "صفصاف الوسرى", "قريقر", "بكارية", "بولحاف الدير", "أم علي", "بوخضرة", "الماء الابيض", "الونزة", "المريج", "عين الزرقاء", "سطح قنطيس", "العقلة", "المزرعة", "بجن", "مرسط", "ثليجان", "الشريعة", "تبسة", "الحمامات", "الكويف"],
        "13": ["باب العسة", "تيرني بني هديل", "منصورة", "بني مستر", "عين غرابة", "شتوان", "عمير", "عين فزة", "هنين", "بني خلاد", "ندرومة", "مسيردة الفواقة", "مرسى بن مهيدي", "سيدي مجاهد", "بني بوسعيد", "سبدو", "بوحلو", "مغنية", "حمام بوغرارة", "زناتة", "أولاد رياح", "الحناية", "سيدي العبدلي", "سوق الثلاثاء", "بن سكران", "فلاوسن", "عين الكبيرة", "عين فتاح", "تلمسان", "عين النحالة", "عين تالوت", "عين يوسف", "بني وارسوس", "الفحول", "الرمشي", "سبعة شيوخ", "السواني", "صبرة", "دار يغمراسن", "الغزوات", "السواحلية", "تيانت", "بني صميل", "وادي الخضر", "أولاد ميمون", "بني بهدل", "بني سنوس", "العزايل", "جبالة"],
        "14": ["مهدية", "عين دزاريت", "السبعين", "الفايجة", "سي عبد الغني", "السوقر", "توسنينة", "مغيلة", "السبت", "سيدي حسني", "عين الحديد", "فرندة", "تخمرت", "عين كرمس", "جبيلات الرصفاء", "مادنة", "مدريسة", "سيدي عبد الرحمن", "قرطوفة", "وادي ليلي", "سيدي علي ملال", "جيلالي بن عمار", "مشرع الصفا", "تاقدمت", "تيدة", "الناظورة", "تيارت", "مدروسة", "ملاكو", "سيدي بختي", "عين الذهب", "شحيمة", "النعيمة", "عين بوشقيف", "دحموني", "الرحوية"],
        "15": ["ميزرانـــة", "إيجــار", "بني دوالة", "بني زيكــي", "إيلولة أومـــالو", "أقني قغران", "أيت بــوادو", "واضية", "تيزي نثلاثة", "أغريب", "أيت شافع", "أقرو", "أزفون", "إفليـــسن", "تيقـزيرت", "أسي يوسف", "بوغني", "بونوح", "مشطراس", "ذراع بن خدة", "سيدي نعمان", "تادمايت", "تيرمتين", "أيت بومهدي", "أيت تودرت", "بني عيسي", "واسيف", "أيت خليلي", "مقــلع", "صوامـــع", "بني يني", "إبودرارن", "تيزي وزو", "أبي يوسف", "عين الحمام", "أيت يحيى", "اقبيل", "بوجيمة", "ماكودة", "عين الزاوية", "أيت يحي موسى", "ذراع الميزان", "فريقات", "مكيرة", "تيزي غنيف", "يطــافن", "إيلـيــلتـن", "إمســوحال", "عزازقة", "فريحة", "إيفيغاء", "إعــكورن", "زكري", "أيت عقـواشة", "إيرجـــن", "الأربعــاء ناث إيراثن", "أيت أومالو", "تيزي راشد", "أيت عيسى ميمون", "واقنون", "تيمـيزار", "معـــاتقة", "سوق الإثنين", "أيت محمود", "بنــــي زمنزار", "إفــرحــونان", "بوزقــن"],
        "16": ["حسين داي", "الكاليتوس", "سيدي موسى", "القبة", "محمد بلوزداد", "عين طاية", "باب الزوار", "برج الكيفان", "الدار البيضاء", "المرسى", "المحمدية", "بئر توتة", "اولاد شبل", "تسالة المرجة", "هراوة", "رغاية", "الرويبة", "المعالمة", "الرحمانية", "سويدانية", "سطاوالي", "زرالدة", "بابا حسن", "الدويرة", "الدرارية", "العاشور", "الخرايسية", "عين بنيان", "الشراقة", "دالي ابراهيم", "الحمامات", "اولاد فايت", "الجزائر الوسطى", "المدنية", "المرادية", "سيدي امحمد", "السحاولة", "بولوغين بن زيري", "القصبة", "وادي قريش", "الرايس حميدو", "بئر مراد رايس", "بئر خادم", "جسر قسنطينة", "حيدرة", "المغارية", "ابن عكنون", "بني مسوس", "بوزريعة", "الابيار", "باش جراح", "بوروبة", "الحراش", "وادي السمار", "براقي", "برج البحري", "باب الوادي"],
        "17": ["حاسي العش", "عين الإبل", "القديد", "الشارف", "بن يعقوب", "سيدي بايزيد", "مليليحة", "دار الشيوخ", "تعظميت", "زكار", "دويس", "الادريسية", "عين الشهداء", "الجلفة", "زعفران", "عين معبد", "حاسي بحبح", "مجبارة"],
        "18": ["جيجل", "العوانة", "سلمى بن زيادة", "أراقن سويسي", "بوسيف أولاد عسكر", "زيامة منصورية", "الشحنة", "الامير عبد القادر", "وجانة", "الطاهير", "الشقفة", "القنار نشفي", "سيدي عبد العزيز", "الميلية", "أولاد يحيى خدروش", "أولاد رابح", "سيدي معروف", "غبالة", "السطارة", "بوراوي بلهادف", "العنصر", "خيري واد عجول", "جيملة", "قاوس", "تاكسنة", "برج الطهر", "بودريعة بني ياجيس", "الجمعة بني حبيبي"],
        "19": ["الرصفة", "واد البارد", "تيزي نبشار", "مزلوق", "قلال", "قصر الابطال", "أولاد سي أحمد", "أيت نوال مزادة", "ايت تيزي", "بوعنداس", "بوسلام", "حمام السخنة", "الطاية", "التلة", "عين ولمان", "بوطالب", "الحامة", "أولاد تبان", "عموشة", "صالح باي", "عين أزال", "عين الحجر", "بيضاء برج", "بئر حدادة", "قنزات", "حربيل", "عين الروى", "بني وسين", "أوريسيا", "بوقاعة", "ذراع قبيلة", "حمام قرقور", "سطيف", "عين الكبيرة", "الدهامشة", "أولاد عدوان", "عين السبت", "بني عزيز", "معاوية", "بلاعة", "بئر العرش", "الولجة", "تاشودة", "تالة إيفاسن", "سرج الغول", "قجال", "أولاد صابر", "بازر سكرة", "العلمة", "قلتة زرقاء", "بني فودة", "جميلة", "عين لقراج", "بني شبانة", "بني ورتيلان", "بني موحلي", "عين عباسة", "عين أرنات", "بابور", "ماوكلان"],
        "20": ["سعيدة", "تيرسين", "أولاد إبراهيم", "عين السلطان", "المعمورة", "الحساسنة", "عين السخونة", "سيدي بوبكر", "أولاد خالد", "هونت", "يوب", "دوي ثابت", "سيدي احمد", "مولاي العربي", "عين الحجر", "سيدي عمر"],
        "21": ["عين بوزيان", "صالح بو الشعور", "الحدائق", "زردازة", "أولاد حبابة", "بني ولبان", "سيدي مزغيش", "بني بشير", "رمضان جمال", "بين الويدان", "مجاز الدشيش", "تمالوس", "عين قشرة", "الولجة بولبلوط", "أم الطوب", "الغدير", "الكركرة", "الحروش", "الزيتونة", "أولاد عطية", "وادي الزهور", "القل", "الشرايع", "بني زيد", "خناق مايو", "المرسى", "بن عزوز", "بكوش لخضر", "السبت", "عين شرشار", "عزابة", "بوشطاطة", "فلفلة", "حمادي كرومة", "سكيكدة", "عين زويت", "جندل سعدي محمد", "قنواع"],
        "22": ["سيدي علي بن يوب", "مولاي سليسن", "الحصيبة", "عين تندمين", "تنيرة", "وادي سفيون", "حاسي دحو", "وادي تاوريرة", "بن عشيبة شلية", "سيدي يعقوب", "سيدي لحسن", "سيدي خالد", "طابية", "سيدي ابراهيم", "العمارنة", "بوخنفيس", "حاسي زهانة", "شيطوان البلايلة", "بن باديس", "بضرابين المقراني", "سفيزف", "مسيد", "بوجبهة البرج", "عين أدن", "سيدي حمادوش", "سيدي شعيب", "مكدرة", "عين البرد", "رجم دموش", "راس الماء", "وادي السبع", "مرحوم", "سيدي بلعباس", "عين الثريد", "السهالة الثورة", "تسالة", "بلعربي", "مصطفى بن ابراهيم", "تلموني", "زروالة", "الضاية", "مزاورو", "تغاليمت", "تلاغ", "عين قادة", "لمطار", "سيدي علي بوسيدي", "سيدي دحو الزاير", "بئر الحمام", "مرين", "تفسور", "تاودموت"],
        "23": ["عنابة", "سرايدي", "برحال", "واد العنب", "الحجار", "سيدي عمار", "البوني", "عين الباردة", "الشرفة", "العلمة", "التريعات", "شطايبي"],
        "24": ["نشماية", "بوحمدان", "حمام دباغ", "الركنية", "الدهوارة", "حمام النبايل", "قالمة", "بومهرة أحمد", "عين بن بيضاء", "بوشقوف", "مجاز الصفاء", "وادي فراغة", "بوعاتي محمود", "الفجوج", "هيليوبوليس", "مجاز عمار", "هواري بومدين", "رأس العقبة", "سلاوة عنونة", "جبالة الخميسي", "برج صباط", "وادي الزناتي", "عين رقادة", "عين العربي", "عين مخلوف", "تاملوكة", "عين صندل", "بوحشانة", "لخزارة", "بلخير", "بني مزلين", "قلعة بوصبع", "وادي الشحم", "بن جراح"],
        "25": ["ديدوش مراد", "حامة بوزيان", "بني حميدان", "زيغود يوسف", "عين السمارة", "الخروب", "أولاد رحمون", "عين عبيد", "أبن باديس الهرية", "ابن زياد", "بوجريو مسعود", "قسنطينة"],
        "26": ["السواقي", "العزيزية", "مغراوة", "ميهوب", "حناشة", "عوامري", "وادي حربيل", "بني سليمان", "بوعيشون", "أولاد بوعشرة", "سي المحجوب", "بوسكن", "سيدي الربيع", "البرواقية", "أولاد دايد", "الربعية", "مجبر", "ثلاث دوائر", "الزبيرية", "العيساوية", "الحوضان", "مزغنة", "تابلاط", "سغوان", "ذراع السمار", "المدية", "تمسقيدة", "بن شكاو", "الحمدانية", "وزرة", "تيزي مهدي", "باعطة", "العمارية", "أولاد إبراهيم", "بئر بن عابد", "القلب الكبير", "سدراية", "بوشراحيل", "خمس جوامع", "سيدي نعمان", "جواب", "سيدي زهار", "سيدي زيان"],
        "27": ["فرناقة", "وادي الخير", "الحسيان (بني ياحي", "حاسي ماماش", "مزغران", "ستيدية", "عين تادلس", "سيدي بلعطار", "سور", "عين بودينار", "خير الدين", "صيادة", "سيدي علي", "تزقايت", "بن عبد المالك رمضان", "مستغانم", "حجاج", "سيدي لخضر", "عشعاشة", "خضرة", "نكمارية", "أولاد بوغالم", "بوقيراط", "صفصاف", "سيرات", "السوافلية", "عين سيدي الشريف", "منصورة", "ماسرة", "الطواهرية", "عين نويسي", "أولاد مع الله"],
        "28": ["شلال", "أولاد ماضي", "خطوطي سد الجير", "بلعايبة", "برهوم", "دهاهنة", "مقرة", "بني يلمان", "بوطي السايح", "سيدي عيسى", "عين الحجل", "جبل مساعد", "المسيلة", "حمام الضلعة", "ونوغة", "أولاد منصور", "تارمونت", "أولاد دراج", "السوامع", "الحوامد", "خبانة", "مسيف", "عين الخضراء", "أولاد عدي لقبالة"],
        "29": ["وادي الأبطال", "سيدي عبد المومن", "سجرارة", "المحمدية", "تيغنيف", "مقطع الدوز", "فراقيق", "الغمري", "زهانة", "القعدة", "رأس عين عميروش", "عقاز", "العلايمية", "سيق", "الشرفاء", "بوهني", "المأمونية", "القطنة", "عين فارس", "غروس", "بنيان", "عوف", "قرجوم", "عين أفرص", "عين فكان", "خلوية", "المنور", "البرج", "سيدي بوسعيد", "المطمور", "سيدي قادة", "ماقضة", "معسكر", "بوحنيفية", "غريس", "حسين", "القرط", "فروحة", "تيزي", "السهايلية", "ماوسة", "سيدي عبد الجبار", "الحشم", "نسمط", "زلامطة", "عين فراح", "وادي التاغية"],
        "30": ["ورقلة", "حاسي مسعود", "عين البيضاء", "حاسي بن عبد الله", "سيدي خويلد", "البرمة", "الرويسات", "انقوسة"],
        "31": ["سيدي الشحمي", "حاسي مفسوخ", "بئر الجير", "حاسي بن عقبة", "قديل", "حاسي بونيف", "الكرمة", "السانية", "بن فريحة", "أرزيو", "سيدي بن يبقى", "عين البية", "بطيوة", "مرسى الحجاج", "عين الترك", "وهران", "العنصر", "المرسى الكبير", "بوفاتيس", "البراية", "وادي تليلات", "عين الكرمة", "بوتليليس", "مسرغين", "بوسفر", "طفراوي"],
        "32": ["عين العراك", "كراكدة", "سيدي سليمان", "سيدي عامر", "بوعلام", "البنود", "بوقطب", "الخيثر", "توسمولين", "سيدي طيفور", "ستيتن", "البيض", "رقاصة", "المحرة", "الكاف الأحمر"],
        "33": ["برج عمر إدريس", "دبداب", "إن أمناس", "إيليزي"],
        "34": ["الحمادية", "أولاد سيدي ابراهيم", "عين تاغروت", "تيكستار", "بليمور", "العناصر", "غيلاسة", "تقلعيت", "برج الغدير", "العش", "سيدي أمبارك", "خليل", "بئر قاصد علي", "تفرق", "الماين", "جعافرة", "القلة", "ثنية النصر", "المهير", "القصور", "المنصورة", "حرازة", "الرابطة", "الياشير", "حسناوة", "مجانة", "عين تسرة", "أولاد أبراهم", "رأس الوادي", "برج زمورة", "أولاد دحمان", "تسامرت", "برج بوعريرج", "بن داود"],
        "35": ["الخروبة", "دلس", "بن شود", "أعفير", "الثنية", "بني عمران", "خميس الخشنة", "عمال", "تيمزريت", "زموري", "الاربعطاش", "يسر", "شعبة العامر", "أولاد عيسى", "الناصرية", "بوزقزة قدارة", "سوق الحد", "سيدي داود", "بغلية", "لقاطة", "جنات", "تيجلابين", "سي مصطفى", "أولاد هداج", "أولاد موسى", "بومرداس", "قورصو", "برج منايل", "بودواو", "بودواو البحري", "تاورقة", "حمادي"],
        "36": ["عين العسل", "بوقوس", "الطارف", "الزيتونة", "البسباس", "عين الكرمة", "بوحجار", "حمام بني صالح", "وادي الزيتون", "بن مهيدي", "بريحان", "شبيطة مختار", "الشط", "العيون", "القالة", "السوارخ", "زريزر", "بوثلجة", "الشافية", "بحيرة الطيور", "شحاني", "رمل السوق", "عصفور", "الذرعـان"],
        "37": ["تندوف", "أم العسل"],
        "38": ["خميستي", "ثنية الاحد", "أولاد بسام", "سيدي بوتوشنت", "تيسمسيلت", "سيدي العنتري", "بني شعيب", "بني لحسن", "سيدي عابد", "سيدي سليمان", "بوقائد", "الأربعاء", "الأزهرية", "لرجام", "الملعب", "العيون", "تملاحت", "اليوسفية", "برج الأمير عبد القادر", "عماري", "المعاصم", "برج بونعامة"],
        "39": ["دوار الماء", "العقلة", "المقرن", "سيدي عون", "اميه وانسة", "كوينين", "البياضة", "النخلة", "الرباح", "قمار", "بن قشة", "ورماس", "تغزوت", "الحمراية", "الرقيبة", "الدبيلة", "حساني عبد الكريم", "حاسي خليفة", "الطريفاوي", "الطالب العربي", "وادي العلندة", "الوادي"],
        "40": ["خيران", "بابار", "المحمل", "أولاد رشاش", "جلال", "يابوس", "خنشلة", "قايس", "شلية", "الرميلة", "تاوزيانت", "بغاي", "الحامة", "انسيغة", "طامزة", "عين الطويلة", "متوسة", "بوحمامة", "الولجة", "مصارة", "ششار"],
        "41": ["سوق أهراس", "عين سلطان", "سدراتة", "الحنانشة", "المشروحة", "عين الزانة", "أولاد إدريس", "ترقالت", "أم العظايم", "وادي الكبريت", "تيفاش", "الراقوبة", "الدريعة", "تاورة", "الزعرورية", "الحدادة", "الخضارة", "أولاد مومن", "المراهنة", "ويلان", "سيدي فرج", "بئر بوحوش", "سافل الويدان", "خميسة", "مداوروش", "الزوابي"],
        "42": ["حجوط", "مراد", "مناصر", "أغبال", "الناظور", "سيدي عامر", "قوراية", "مسلمون", "شرشال", "حجرة النص", "سيدي غيلاس", "الداموس", "الأرهاط", "فوكة", "عين تاقورايت", "بوهارون", "بواسماعيل", "خميستي", "أحمر العين", "بورقيقة", "دواودة", "سيدي راشد", "الحطاطبة", "الشعيبة", "القليعة", "سيدي سميان", "تيبازة", "بني ميلك"],
        "43": ["مشيرة", "العياضي برباس", "عين البيضاء أحريش", "تسالة لمطاعي", "ترعي باينان", "اعميرة اراس", "تسدان حدادة", "مينار زارزة", "سيدي مروان", "الشيقارة", "حمالة", "القرارم قوقة", "تيبرقنت", "الرواشد", "دراحي بوصلاح", "زغاية", "وادي النجاء", "أحمد راشدي", "تاجنانت", "عين الملوك", "أولاد اخلوف", "بن يحي عبد الرحمن", "التلاغمة", "وادي سقان", "وادي العثمانية", "عين التين", "شلغوم العيد", "يحي بني قشة", "فرجيوة", "سيدي خليفة", "ميلة", "بوحاتم"],
        "44": ["خميس مليانة", "سيدي الأخضر", "عين البنيان", "عين التركي", "حمام ريغة", "بوراشد", "الحسينية", "جليدة", "عريب", "جمعة أولاد الشيخ", "العامرة", "العطاف", "تبركانين", "عين بويحيى", "العبادية", "تاشتة زقاغة", "بربوش", "جندل", "بن علال", "وادي الشرفاء", "بومدفع", "عين الاشياخ", "عين السلطان", "واد الجمعة", "الماين", "الروينة", "زدين", "بئر ولد خليفة", "برج الأمير خالد", "طارق بن زياد", "بطحية", "بلعاص", "الحسانية", "عين الدفلى", "مليانة", "المخاطرية"],
        "45": ["تيوت", "مغرار", "عسلة", "القصدير", "مكمن بن عمار", "عين الصفراء", "المشرية", "البيوض", "عين بن خليل", "النعامة", "جنين بورزق", "سفيسيفة"],
        "46": ["سيدي بومدين", "تامزورة", "شعبة اللحم", "المالح", "أولاد الكيحل", "شنتوف", "تارقة", "وادي الصباح", "العامرية", "حاسي الغلة", "أولاد بوجمعة", "أغلال", "عين الكيحل", "عين الطلبة", "عقب الليل", "بني صاف", "الحساسنة", "الأمير عبد القادر", "سيدي صافي", "ولهاصة الغرابة", "سيدي ورياش", "عين الأربعاء", "المساعيد", "وادي برقش", "سيدي بن عدة", "عين تموشنت", "بوزجار", "حمام بوحجر"],
        "47": ["ضاية بن ضحوة", "المنصورة", "العطف", "بونورة", "زلفانة", "القرارة", "سبسب", "متليلي", "بريان", "غرداية"],
        "48": ["القطار", "أولاد يعيش", "بني درقن", "دار بن عبد الله", "زمورة", "جديوية", "حمري", "بلعسل بوزقزة", "المطمر", "سيدي خطاب", "سيدي امحمد بن عودة", "عين طارق", "حد الشكالة", "الولجة", "مازونة", "عين الرحمة", "القلعة", "سيدي سعادة", "يلل", "سوق الحد", "منداس", "وادي السلام", "سيدي لزرق", "عمي موسى", "واريزان", "مرجة سيدي عابد", "أولاد سيدي الميهوب", "بن داود", "وادي رهيو", "الحاسي", "سيدي أمحمد بن علي", "مديونة", "بني زنطيس", "وادي الجمعة", "لحلاف", "غليزان", "الحمادنة", "الرمكة"],
        "49": ["تنركوك", "تيميمون", "أولاد السعيد", "المطارفة", "طالمين", "أولاد عيسى", "شروين", "أوقروت", "دلدول", "قصر قدور"],
        "50": ["تيمياوين", "برج باجي مختار"],
        "51": ["رأس الميعاد", "بسباس", "سيدي خالد", "الدوسن", "الشعيبة", "أولاد جلال"],
        "52": ["بني عباس", "تامترت", "إقلي", "الواتة", "أولاد خضير", "كرزاز", "تيمودي", "القصابي", "بن يخلف"],
        "53": ["إينغر", "عين صالح", "فقارة الزوى"],
        "54": ["تين زواتين", "عين قزام"],
        "55": ["تماسين", "سيدي سليمان", "المقارين", "النزلة", "بلدة اعمر", "تبسبست", "تقرت", "الطيبات", "العالية", "الحجيرة", "بن ناصر", "المنقر", "الزاوية العابدية"],
        "56": ["جانت", "برج الحواس"],
        "57": ["أم الطيور", "سيدي عمران", "المرارة", "جامعة", "تندلة", "المغير", "سطيل", "سيدي خليل"],
        "58": ["المنيعة", "حاسي القارة", "حاسي الفحل"],
        "59": ["البيضاء", "قلتة سيدي سعد", "بريدة", "عين سيدي علي", "الحاج مشري", "تاويالة", "الغيشة", "سبقاق", "سيدي بوزيد", "وادي مرة", "وادي مزي", "أفلو"],
        "60": ["بريزينة", "الغاسول", "الأبيض سيدي الشيخ", "بوسمغون", "الشقيق", "شلالة", "اربوات"],
        "61": ["سيدي الجيلالي", "البويهي", "القور", "العريشة"],
        "62": ["جمورة", "برانيس", "الوطاية", "القنطرة", "عين زعطوط"],
        "63": ["سقانة", "تيلاطو", "بريكة", "بيطام", "إمدوكل", "عزيل عبد القادر", "الجزار", "أولاد عمار"],
        "64": ["سيدي هجرس", "بوسعادة", "الهامل", "ولتام", "بن زوه", "أولاد سيدي ابراهيم", "سيدي عامر", "تامسة", "بن سرور", "محمد بوضياف", "أولاد سليمان", "زرزور", "عين الملح", "عين فارس", "عين الريش", "بئر فضة", "سيدي امحمد", "امجدل", "مناعة", "المعاضيد", "المطارفة", "معاريف", "سليم"],
        "65": ["فركان", "نقرين", "العقلة المالحة", "بئر العاتر"],
        "66": ["أولاد هلال", "قصر البخاري", "مفاتحة", "السانق", "بوعيش", "بوغزول", "الشهبونية", "عين بوسيف", "العوينات", "الكاف الاخضر", "أولاد امعرف", "سيدي دامد", "عين اقصير", "شلالة العذاورة", "شنيقل", "تفراوت", "بوغار", "عزيز", "دراق", "أم الجليل", "أولاد عنتر"],
        "67": ["قصر الشلالة", "سرغين", "زمالة الأمير عبد القادر", "بوقرة", "حمادية", "الرشايقة"],
        "68": ["حد الصحاري", "بويرة الأحداب", "عين فقه", "سيدي لعجال", "حاسي فدول", "الخميس", "بيرين", "قرنيني", "عين وسارة", "بنهار"],
        "69": ["سلمانة", "سد الرحال", "مسعد", "قطارة", "دلدول", "أم العظام", "فيض البطمة", "عمورة"]
    }
};

// Initialize the form on page load
document.addEventListener('DOMContentLoaded', function() {
    initializeAlgeriaSelects();
    initializeFormSubmission();
    applyUIEnhancements();
});

// Initialize Algeria province and commune selects
function initializeAlgeriaSelects() {
    const provinceSelect = document.querySelector(`select[name="${CONFIG.provinceFieldName}"]`);
    const communeSelect = document.querySelector(`select[name="${CONFIG.communeFieldName}"]`);
    
    if (!provinceSelect || !communeSelect) {
        console.error('Province or Commune select not found');
        return;
    }
    
    // Populate provinces
    populateProvinces(provinceSelect);
    
    // Add event listener for province change
    provinceSelect.addEventListener('change', function() {
        const selectedProvinceId = this.value;
        populateCommunes(communeSelect, selectedProvinceId);
    });
}

// Populate provinces dropdown
function populateProvinces(selectElement) {
    // Clear existing options except the first one
    selectElement.innerHTML = '<option value="">اختر الولاية</option>';
    
    // Add all provinces
    ALGERIA_DATA.wilayas.forEach(wilaya => {
        const option = document.createElement('option');
        option.value = wilaya.id;
        option.textContent = `${wilaya.id < 10 ? '0' + wilaya.id : wilaya.id} - ${wilaya.name_ar}`;
        option.setAttribute('data-latin', wilaya.name_latin);
        selectElement.appendChild(option);
    });
}

// Populate communes based on selected province
function populateCommunes(selectElement, provinceId) {
    // Clear existing options
    selectElement.innerHTML = '<option value="">اختر البلدية</option>';
    
    if (!provinceId || !ALGERIA_DATA.communes[provinceId]) {
        return;
    }
    
    // Add communes for the selected province
    const communes = ALGERIA_DATA.communes[provinceId];
    communes.forEach(commune => {
        const option = document.createElement('option');
        option.value = commune;
        option.textContent = commune;
        selectElement.appendChild(option);
    });
    
    // Enable the commune select
    selectElement.disabled = false;
}

// Initialize form submission with Google Sheets integration
function initializeFormSubmission() {
    const form = document.querySelector('#express-checkout-form');
    
    if (!form) {
        console.error('Checkout form not found');
        return;
    }
    
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Collect form data
        const formData = collectFormData(form);
        
        // Validate form
        if (!validateForm(formData)) {
            alert('الرجاء ملء جميع الحقول المطلوبة');
            return;
        }
        
        // Send to Google Sheets
        sendToGoogleSheets(formData);
        
        // Also submit the original form
        form.submit();
    });
}

// Collect form data
function collectFormData(form) {
    const formData = new FormData(form);
    const data = {};
    
    // Get all form fields
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    
    // Add timestamp
    data.timestamp = new Date().toISOString();
    
    // Get province and commune names
    const provinceSelect = form.querySelector(`select[name="${CONFIG.provinceFieldName}"]`);
    const communeSelect = form.querySelector(`select[name="${CONFIG.communeFieldName}"]`);
    
    if (provinceSelect && provinceSelect.selectedIndex > 0) {
        data.province_name = provinceSelect.options[provinceSelect.selectedIndex].text;
        data.province_latin = provinceSelect.options[provinceSelect.selectedIndex].getAttribute('data-latin');
    }
    
    if (communeSelect && communeSelect.selectedIndex > 0) {
        data.commune_name = communeSelect.options[communeSelect.selectedIndex].text;
    }
    
    return data;
}

// Validate form data
function validateForm(data) {
    const requiredFields = [
        'first_name',
        'phone',
        CONFIG.provinceFieldName,
        CONFIG.communeFieldName,
        CONFIG.deliveryFieldName
    ];
    
    for (let field of requiredFields) {
        if (!data[field] || data[field] === '' || data[field].startsWith('اختر')) {
            return false;
        }
    }
    
    return true;
}

// Send data to Google Sheets
function sendToGoogleSheets(data) {
    // Check if webhook URL is configured
    if (CONFIG.googleSheetsWebhook === 'https://script.google.com/macros/s/AKfycbxBgK2uSP7-WM_0E-rTRHbT2Sql1vJY6PNqOG6DpluIxs7iVG4mg-84-1tZp7zs1WzkOQ/exec') {
        console.warn('Google Sheets webhook not configured');
        return;
    }
    
    fetch(CONFIG.googleSheetsWebhook, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(() => {
        console.log('Data sent to Google Sheets successfully');
    })
    .catch(error => {
        console.error('Error sending data to Google Sheets:', error);
    });
}

// Apply UI enhancements
function applyUIEnhancements() {
    // Remove product-section class and add custom styling
    const productWrapperElement = document.querySelector('.product-wrapper .product-details .product-section');
    if (productWrapperElement) {
        productWrapperElement.classList.remove('product-section');
        productWrapperElement.classList.add('product-section', 's-flex');
    }
    
    // Remove countdown section if exists
    const countdownSection = document.querySelector('.single-progress');
    if (countdownSection) {
        countdownSection.remove();
    }
    
    // Add star ratings
    addStarRatings();
    
    // Update checkout heading
    updateCheckoutHeading();
}

// Add star ratings to product
function addStarRatings() {
    // Home page ratings
    const productTitles = document.getElementsByClassName("product-title");
    if (productTitles.length > 0) {
        Array.from(productTitles).forEach(title => {
            const ratingDiv = document.createElement("div");
            ratingDiv.innerHTML = '<span class="fa fa-star checked"></span>'.repeat(5);
            title.appendChild(ratingDiv);
        });
    }
    
    // Product page ratings
    const priceSections = document.getElementsByClassName("product-section price-section");
    if (priceSections.length > 0) {
        const ratingDiv = document.createElement("div");
        ratingDiv.setAttribute("class", "rvw_stars");
        ratingDiv.innerHTML = '<span class="fa fa-star checked"></span>'.repeat(5);
        priceSections[0].parentNode.insertBefore(ratingDiv, priceSections[0].nextSibling);
    }
    
    // Add star styling
    const style = document.createElement('style');
    style.textContent = `
        span.fa.fa-star.checked {
            color: #FFC107;
            transform: scale(1.3);
            margin: 10px 4px 0px 4px;
        }
        .rvw_stars span.fa.fa-star.checked {
            position: relative;
            left: 4px;
            transform: scale(1.4);
            margin: 0px 8px 12px 0px;
        }
    `;
    document.head.appendChild(style);
}

// Update checkout heading
function updateCheckoutHeading() {
    const headingElement = document.querySelector('.checkout-heading');
    if (headingElement) {
        headingElement.textContent = 'الرجاء ملء المعلومات في الخانات أدناه. ثم إضغط على زر \'تأكيد الطلب\'';
    }
}

console.log('YouCan Algeria Integration Script Loaded Successfully');
</script>